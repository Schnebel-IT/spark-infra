# Generated by Ansible - SSH Configuration for Spark Infrastructure

Port {{ ssh.port }}
Protocol 2

# Logging
SyslogFacility AUTH
LogLevel INFO

# Authentication
LoginGraceTime 2m
{% if ssh.disable_root_login %}
PermitRootLogin no
{% else %}
PermitRootLogin yes
{% endif %}
StrictModes yes
MaxAuthTries 6
MaxSessions 10

# Public key authentication
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys

# Password authentication
{% if ssh.disable_password_auth %}
PasswordAuthentication no
{% else %}
PasswordAuthentication yes
{% endif %}
PermitEmptyPasswords no

# Challenge response authentication
ChallengeResponseAuthentication no

# Kerberos options
KerberosAuthentication no
KerberosOrLocalPasswd yes
KerberosTicketCleanup yes

# GSSAPI options
GSSAPIAuthentication no
GSSAPICleanupCredentials yes

# Set this to 'yes' to enable PAM authentication, account processing,
# and session processing.
UsePAM yes

# Allow client to pass locale environment variables
AcceptEnv LANG LC_*

# Override default of no subsystems
Subsystem sftp /usr/lib/openssh/sftp-server

# Security settings
ClientAliveInterval 300
ClientAliveCountMax 2
TCPKeepAlive yes
Compression delayed
X11Forwarding no
PrintMotd no

# Allow only specific users (if needed)
# AllowUsers ubuntu root

# Restrict to specific groups
# AllowGroups ssh-users
